# 春节祝福语生成器

一个基于 Flask 的春节祝福语生成应用，结合传统文化与 AI 技术，提供古色古香的视觉体验和个性化的祝福语生成服务。

## 项目简介

本项目是一个春节主题的 Web 应用，通过 AI 模型自动生成各种风格的春节祝福语。用户可以输入年份，应用会自动推断农历年份、干支纪年和生肖。支持多种祝福语类别、风格选择、关键词定制、字体个性化以及印章定制功能，并提供一键复制和保存为图片功能。

## 技术栈

### 后端
- **Flask 3.0.0**: Python Web 框架
- **requests 2.31.0**: HTTP 请求库

### 前端
- **原生 JavaScript**: 前端交互逻辑
- **CSS3**: 春节主题样式，响应式设计
- **html2canvas**: 图片生成库

### AI 模型
- **ModelArts Studio API**: deepseek-v3.2 模型用于祝福语生成

## 项目结构

```
chunjie/
├── app.py              # Flask 主应用，包含祝福语生成逻辑和 API 路由
├── lunar_utils.py      # 农历工具模块，提供生肖和干支纪年计算
├── requirements.txt    # Python 依赖列表
├── run.sh              # 应用启动脚本
├── templates/
│   └── index.html      # 古色古香风格的前端页面
└── static/
    ├── css/
    │   └── style.css   # 春节主题样式
    └── js/
        └── app.js      # 前端交互逻辑
```

## 主要功能

- 📅 **农历信息自动推断**: 根据输入年份自动计算干支纪年和生肖
- 🎊 **四种祝福语类别**（按字数从少到多排列）:
  - 拜年词（8-16字，简短精巧，语言凝练）
  - 朋友圈（50-80字，适合微信朋友圈）
  - 微博（140字以内，适合微博发布）
  - 新春贺词（内容丰富，适合海报贺卡）
- 🎨 **三种风格选择**:
  - 现代创新风格（活泼有创意，融入流行语）
  - 古色古香风格（古雅有韵味，文言文表达）
  - 传统风格（正式庄重，传统习俗）
- 🔤 **关键词定制**: 支持输入关键词，AI围绕关键词创作祝福语
- ✍️ **四种字体选择**:
  - 书法字体（行云流水，古韵悠长）
  - 宋体（横细竖粗，典雅大方）
  - 草书（狂放不羁，艺术感强）
  - 微软雅黑（现代简洁，清晰美观）
- 🔖 **印章定制功能**:
  - 支持自定义印章文字（1-12字）
  - 印章字体采用书法字体（Ma Shan Zheng、ZCOOL XiaoWei等）
  - 印章大小根据字数自动调整，字体大小保持一致
  - 保持传统印章风格（从右到左阅读，倾斜12度）
- 📋 **一键复制**: 方便快速复制生成的祝福语
- 🖼️ **保存为图片**: 将祝福语展示效果保存为PNG图片
- 📱 **响应式设计**: 支持桌面和移动设备，自动缩放适配

## 印章定制说明

印章支持1-12个字符的自定义，系统会根据字数自动调整布局和印章大小：

| 字数 | 布局 | 字体大小 | 印章尺寸 |
|------|------|----------|----------|
| 1字 | 1列1行 | 20px | 50px |
| 2字 | 1列2行 | 20px | 60px |
| 3-4字 | 2列2行 | 20px | 75px |
| 5-6字 | 2列3行 | 20px | 90px |
| 7-9字 | 3列3行 | 20px | 110px |
| 10-12字 | 4列3行 | 20px | 130px |

印章特点：
- 字体大小固定为20px，确保视觉一致性
- 印章尺寸随字数增加而扩大
- 保持传统印章的阅读方向（从右到左）
- 倾斜角度固定为-12度，呈现真实印章效果

## 环境变量配置

在运行应用前，需要配置以下环境变量：

```bash
export API_URL="API_URL"
export MODEL_NAME="MODEL_NAME"
export API_KEY="API_KEY"
```

## 安装与运行

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 配置环境变量

需要执行以下命令：

```bash
export API_URL="API_URL"
export MODEL_NAME="MODEL_NAME"
export API_KEY="API_KEY"
```

### 3. 运行应用

使用启动脚本：

```bash
bash run.sh
```

或直接运行：

```bash
python app.py
```

应用将在 `http://localhost:5000` 启动。

## API 接口

### POST /generate

生成春节祝福语

**请求参数**:
```json
{
  "year": 2025,
  "category": "拜年词",
  "style": "传统风格",
  "keyword": ""  // 可选，关键词
}
```

**响应示例**:
```json
{
  "blessing": "金龙献瑞，福满人间...",
  "lunar_year": "乙巳年",
  "zodiac": "蛇"
}
```

### GET /health

健康检查接口

**响应示例**:
```json
{
  "status": "ok"
}
```

## 核心模块说明

### lunar_utils.py
提供农历相关工具函数：
- `get_lunar_info(year)`: 根据年份获取农历信息（干支纪年和生肖）

### app.py
Flask 应用主文件：
- `/`: 主页路由
- `/generate`: 祝福语生成 API（POST）
- `/health`: 健康检查接口（GET）
- `generate_blessing()`: 调用 AI 模型生成祝福语
- `clean_markdown()`: 清除 markdown 语法和 emoji 表情

## 特色功能

1. **智能农历计算**: 根据输入年份自动识别干支和生肖
2. **多样化祝福语**: 支持不同场景和风格的祝福语生成，包括简短精巧的拜年词
3. **关键词定制**: 支持输入关键词，AI围绕关键词创作个性化祝福语
4. **字体个性化**: 提供四种字体选择，满足不同审美需求
5. **印章定制**: 支持自定义印章文字，自动调整布局和大小
6. **保存为图片**: 一键将祝福语展示效果保存为PNG图片，方便分享
7. **古风设计**: 红色为主色调，宣纸背景，配以中国传统元素和印章装饰
8. **即时生成**: 基于 AI 模型快速生成个性化内容
9. **响应式布局**: 自动适配不同屏幕尺寸，支持窗口缩放

## 注意事项

- 需要有效的 ModelArts Studio API 密钥
- 建议使用 Python 3.8 或更高版本
- 网络连接需要能够访问 ModelArts API 服务
- 农历计算基于公历日期，可能存在微小误差

## 许可证

本项目仅供学习和交流使用。

## 贡献

欢迎提交 Issue 和 Pull Request！
